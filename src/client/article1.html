<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Article Un.</title>
</head>
<body>
    <h3>Titre article</h3>
    <p>Contenu article.</p>
    <p id="commentaires"></p>
    <script>

    // ajax cross domain:
    // (function() {
    //     var xhr = new (window.XDomainRequest || window.XMLHttpRequest)();
    //     xhr.onload = function() {
    //         console.log(xhr);
    //         var comz = JSON.parse(xhr.responseText);
    //         console.log(comz);
    //         document.getElementById("commentaires").innerHTML = xhr.responseText;
    //     }
    //     xhr.open("GET", blah_api + "lehollandaisvolant.net/123/comments");
    //     xhr.send();
    // })();

    (function() {
        window.blah = window.blah || {};
        blah.url_api = "http://127.0.0.1:5000/api/";
        blah.site = "nomdusite";
        blah.article = "42";

        blah.onComments = function(comments) {
            console.log(comments);
        };

        blah.post = function(comment) {
            var xhr = new (window.XDomainRequest || window.XMLHttpRequest)();
            xhr.onload = function() {
                console.log(xhr);
                var comz = JSON.parse(xhr.responseText);
                console.log(comz);
                document.getElementById("commentaires").innerHTML = xhr.responseText;
            }
            xhr.open("POST", blah.url_api + blah.site + "/" + blah.article + "/post");
            xhr.setRequestHeader('Content-Type', 'application/json;charset=UTF-8');
            xhr.send(JSON.stringify(comment));
        };

        // dynamic script loading:
        var scr = document.createElement('script');
        scr.type = 'text/javascript';
        scr.async = true;
        scr.src = blah.url_api + blah.site + "/" + blah.article + "/embed.js"
        document.getElementsByTagName('head')[0].appendChild(scr);
    })();
    </script>
</body>
</html>